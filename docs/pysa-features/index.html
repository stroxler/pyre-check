<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8CK1L365DB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8CK1L365DB",{})</script>
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Feature Annotations | Pyre</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-react-helmet="true" name="twitter:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-react-helmet="true" property="og:url" content="https://pyre-check.org/docs/pysa-features"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Feature Annotations | Pyre"><meta data-react-helmet="true" name="description" content="Features (sometimes called breadcrumbs) are additional metadata that are"><meta data-react-helmet="true" property="og:description" content="Features (sometimes called breadcrumbs) are additional metadata that are"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pyre-check.org/docs/pysa-features"><link data-react-helmet="true" rel="alternate" href="https://pyre-check.org/docs/pysa-features" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pyre-check.org/docs/pysa-features" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9178da2e.css">
<link rel="preload" href="/assets/js/runtime~main.be292107.js" as="script">
<link rel="preload" href="/assets/js/main.2a1c4995.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started">Type Checking (Pyre)</a></li><li><a class="dropdown__link" href="/docs/pysa-basics">Static Analysis (Pysa)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/pyre-check" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">How Pysa Works</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-basics">Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pysa-features">Feature Annotations</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-advanced">Advanced Topics</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-implementation-details">Implementation Details</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-running">Running Pysa</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-shipping-rules-models">Shipping Pysa Models and Rules</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Scaling Beyond Individual Models</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development Tips</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/static-analysis-post-processor">Static Analysis Processor</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Warning Codes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-additional-resources">Additional Resources</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-explore">Exploring Taint Models Interactively</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_1lV3"><div class="docItemContainer_zt2Y"><article><header><h1 class="docTitle_1y8q">Feature Annotations</h1></header><div class="markdown"><p>Features (sometimes called breadcrumbs) are additional metadata that are
associated with taint flows. They can be useful for helping to filter out false
positives, or for zeroing in on high-signal subsets of a rule. Some are
automatically added during the analysis process, and there is a rich system for
manually specifying additional features.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="manually-added-features"></a>Manually Added Features<a class="hash-link" href="#manually-added-features" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="via-feature-using-via"></a><code>via</code> Feature Using <code>Via[]</code><a class="hash-link" href="#via-feature-using-via" title="Direct link to heading">#</a></h3><p>The <code>via</code> feature indicates that a flow passed through a point in the code, such
as a function parameter, that was annotated with the specified feature name. For
example, <code>via:getattr</code> might indicate that the flow passed through a call to
<code>getattr</code></p><p>Feature names are declared in your <code>taint.config</code> file (the same file as
sources/sinks/rules) like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">features</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;getattr&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        comment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;via getattr first parameter&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;request_files&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        comment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;via django request.FILES&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>via</code> feature can be appended to <code>TaintSource</code>, <code>TaintSink</code> and
<code>TaintInTaintOut</code> annotations, to add extra metadata to any flow that goes
through that annotated function/parameter/attribute. This is done by adding
<code>Via[FEATURE_NAME]</code> within square brackets after the <code>TaintXXXX</code> annotation in a
model file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Augmenting TaintSource</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">FILES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">UserControlled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Via</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">request_files</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Augmenting TaintInTaintOut</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getattr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    o</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintInTaintOut</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Via</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">getattr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">GetAttr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintInTaintOut</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">LocalReturn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Pysa also supports attaching features to inferred flows, which allows you to
filter flows passing through a function without having to annotate the taint
yourself explicitly, and having the feature attached to all taint flowing
through the function. This is done by adding the <code>AttachToSource</code>,
<code>AttachToSink</code>, and <code>AttachToTito</code> annotations in a model file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Attaching taint to sources.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_signed_cookie</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> AttachToSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Via</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">signed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Attaching taint to sinks.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> HttpResponseRedirect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> redirect_to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> AttachToSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Via</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">redirect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Attaching taint to taint-in-taint-out models.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> attach_features</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">tito_and_sink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">arg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> AttachToTito</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Via</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">some_feature_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Pysa additionally supports attaching features to flows irrespective of sources,
sinks, and TITO, using the <code>AddFeatureToArgument</code> annotation:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> add_feature_to_argument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_feature_to_first</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  first</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> AddFeatureToArgument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Via</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">string_concat_lhs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  second</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that <strong>Pysa automatically adds some <code>via</code> features with special meaning</strong>.
See the Automatic Features section for details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="via-value-feature-using-viavalueof"></a><code>via-value</code> Feature Using <code>ViaValueOf[]</code><a class="hash-link" href="#via-value-feature-using-viavalueof" title="Direct link to heading">#</a></h3><p>The <code>via-value</code> feature is similar to the <code>via</code> feature, however, it captures
<em>the value of the specified argument, rather than a feature name</em>. Note that
this only works for string literals, boolean literals, numeric literals, and enums.
For example, <code>via-value:Access-Control-Allow-Origin</code> might indicate that the string
literal <code>Access-Control-Allow-Origin</code> was used to set a header in a Django response.</p><p>The <code>via-value</code> feature can be added anywhere that the <code>via</code> feature can be
added. It is added by specifying <code>ViaValueOf[PARAMETER_NAME]</code>, where
<code>PARAMETER_NAME</code> is the name of the function parameter for which you would like
to capture the argument value. To continue the above example, this is how you
would capture the name of a header being set on a Django <code>HttpResponse</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">HttpResponse</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__setitem__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">ResponseHeaderName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">ResponseHeaderValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaValueOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In cases where the argument is not a constant, the feature will appear as
<code>via-value:&lt;unknown:ARGUMENT_TYPE&gt;</code>, where <code>ARGUMENT_TYPE</code> indicates how the
argument value is provided at the callsite. For a model such as this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">first</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> second</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> third</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> TaintSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaValueOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">second</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The following function invocations will produce the features shown
in the comments:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">f(*args)            # Generates via-value:&lt;unknown:args&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">f(**kwargs)         # Generates via-value:&lt;unknown:kwargs&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">f(second=foo)       # Generates via-value:&lt;unknown:named&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">f(foo, bar)         # Generates via-value:&lt;unknown:positional&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">f(*args, **kwargs)  # Generates via-value:&lt;unknown:args_or_kwargs&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If the argument is not provided at the call site (e.g,
using the default value), the feature will appear as <code>via-value:&lt;missing&gt;</code>.</p><p>You can also associate a tag with a <code>via-value</code> feature to ensure that different
<code>via-value</code> annotations don&#x27;t interfere with each other. Here&#x27;s how you can retain
the information that the name of the header was being set:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">HttpResponse</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__setitem__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">ResponseHeaderName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">ResponseHeaderValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaValueOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> WithTag</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;set-header&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The feature would now appear as <code>via-set-header-value:Access-Control-Allow-Origin</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="via-type-feature-using-viatypeof"></a><code>via-type</code> Feature Using <code>ViaTypeOf[]</code><a class="hash-link" href="#via-type-feature-using-viatypeof" title="Direct link to heading">#</a></h3><p>The <code>via-type</code> feature is nearly identical to the <code>via-value</code> feature, however,
it captures <em>the type of the specified argument, rather than it&#x27;s value</em>. Pysa
will retrieve the type information for the argument from Pyre, and add a feature
such as <code>&quot;via-type&quot;: &quot;str&quot;</code>, <code>&quot;via-type&quot;: &quot;typing.List[str]&quot;</code>, or <code>&quot;via-type&quot;:
&quot;typing.Any&quot;</code> (in the case Pyre doesn&#x27;t have type information).</p><p><code>ViaTypeOf</code> is useful for sinks such as <code>subprocess.run</code>, which accepts
<code>Union[bytes, str, Sequence]</code> for it&#x27;s <code>arg</code> parameter. The <code>via-type</code> feature
can help identify which type the argument to <code>arg</code> actually had. Knowing the
type of the argument can help assess the severity of a given issue (user
controlled input in a <code>str</code> passed to <code>arg</code> is much easier to exploit for RCE
than user controlled input in one element of a <code>Sequence</code> passed to <code>arg</code>).</p><p>The <code>via-value</code> feature can be added anywhere that the <code>via</code> feature can be
added. It is added by specifying <code>ViaTypeOf[PARAMETER_NAME]</code>, where
<code>PARAMETER_NAME</code> is the name of the function parameter for which you would like
to capture the argument value:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> subprocess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RemoteCodeExecution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaTypeOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>via-type</code> feature also supports adding tags, using the same syntax as the <code>via-value</code>
feature:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> subprocess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RemoteCodeExecution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaTypeOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> WithTag</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subprocess-arg&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>ViaTypeOf</code> can also be used on attribute or global models, although tags are not supported. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">my_module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MyClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaTypeOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">my_module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MyClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaTypeOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>A standalone <code>ViaTypeOf</code> is also supported in this case, and is shorthand for <code>TaintInTaintOut[ViaTypeOf]</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">my_module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MyClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">my_attribute</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ViaTypeOf </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="supporting-features-dynamically-using-viadynamicfeature"></a>Supporting Features Dynamically Using <code>ViaDynamicFeature[]</code><a class="hash-link" href="#supporting-features-dynamically-using-viadynamicfeature" title="Direct link to heading">#</a></h3><p>In general, Pysa requires you to specify the list of features that are allowed. This encourages features
to be documented, and help avoid typos when writing features so that the features propagating in the analysis are
consistent with filters you might have on issues.</p><p>However, there might be very specific cases where you want to dynamically generate features, depending on artifacts
of the code. Most cases here can be handled by <code>via-type</code> and <code>via-value</code> features, however, you might be dealing with
dynamic code or metadata that the system can&#x27;t detect. In these cases, Pysa allows skipping validation on features
by the use of <code>ViaDynamicFeature</code>. This syntax has identical behavior to <code>Via[]</code> except the lack of validation. Here&#x27;s an example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> subprocess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RemoteCodeExecution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViaDynamicFeature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">subprocess_run_execution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="automatic-features"></a>Automatic Features<a class="hash-link" href="#automatic-features" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="via-feature"></a><code>via</code> Feature<a class="hash-link" href="#via-feature" title="Direct link to heading">#</a></h3><p>In addition to the manually specified <code>via</code> features, Pysa automatically adds
some <code>via</code> features with special meaning such as <code>via:obscure</code>,
<code>via:format-string</code>, and <code>via:tito</code>. <code>via:obscure</code> means that the flow passed
through code that Pysa does not have access to analyze, and thus some taint flow
assumptions were made. This can be a useful to filter out flows that may be more
noisy. <code>via:format-string</code> means that a flow passed through a <a href="https://www.python.org/dev/peps/pep-0498/" target="_blank" rel="noopener noreferrer">python
f-string</a> (<code>f&quot;Variable:
{variable_name}&quot;</code>) or a <code>str.format</code>. Tito stands for taint-in-taint-out which refers to taint
flows that enter a function via a parameter and then exit it in some form via
the return value. The <code>via:tito</code> feature is attached automatically to all such
flows.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="type-feature"></a><code>type</code> Feature<a class="hash-link" href="#type-feature" title="Direct link to heading">#</a></h3><p>The <code>type</code> feature is an automatically added feature which indicates that the
flow passes through a conversion to the specified type. This feature currently
only tracks conversion to numeric values (ie. <code>type:scalar</code>). This can be useful
for filtering out flows when numeric values are highly unlikely to result in an
exploitable flow, such as SQL injection or RCE.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="first-field-feature"></a><code>first-field</code> Feature<a class="hash-link" href="#first-field-feature" title="Direct link to heading">#</a></h3><p>The <code>first-field</code> feature is automatically added to flows for the first field
access on the flow. E.g., if <code>request</code> is a source, and the flow starts with
<code>request.f</code>, then <code>first-field:f</code> should be attached to the flow.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="first-index-feature"></a><code>first-index</code> Feature<a class="hash-link" href="#first-index-feature" title="Direct link to heading">#</a></h3><p>The <code>first-index</code> feature is an automatically added feature which indicates that
a flow starts with a dictionary access using the specified constant as the key.
This is useful in cases such as Django&#x27;s <code>GET</code>/<code>POST</code>/<code>META</code> dictionaries on the
<code>HttpRequest</code> object. A flow that started with as access of the <code>HTTP_REFERER</code>
header from the <code>META</code> object would result in the <code>first-index:HTTP_REFERER</code>
feature being added.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="has-feature"></a><code>has</code> Feature<a class="hash-link" href="#has-feature" title="Direct link to heading">#</a></h3><p>The <code>has</code> features is a summary feature for <code>first-field</code> and <code>first-index</code>.
Thus, <code>has:first-index</code> simply indicates that there is at least one
<code>first-index:&lt;name&gt;</code> feature present, and similarly for <code>has:first-field</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="always--modifier-on-features"></a><code>always-</code> Modifier on Features<a class="hash-link" href="#always--modifier-on-features" title="Direct link to heading">#</a></h3><p>The <code>always-</code> modifier will automatically be added to any of the above features,
when every single flow within an issue has the feature. For example, if an issue
captures flows from three different sources of user input into a SQL sink, the
<code>always-type:scalar</code> modifier would be added if all three of those flows pass
through a conversion to <code>int</code> before reaching the sink. Note that <strong>the
<code>always-</code> version of a feature is <em>exclusive</em> with the non-<code>always-</code> version</strong>;
if <code>always-type:scalar</code> is present, <code>type:scalar</code> will not be present.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="broadening-feature"></a><code>broadening</code> Feature<a class="hash-link" href="#broadening-feature" title="Direct link to heading">#</a></h3><p>The <code>broadening</code> feature is automatically added whenever Pysa makes an
approximation about a taint flow. This is also referred as &quot;taint collapsing&quot;
because the taint is internally represented as a tree structure where edges are
attributes or indexes. Collapsing usually leads to tainting a whole object
instead of a single attribute of that object.</p><p>Pysa also provides more fine grained features for all scenario where we make
approximations.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="widen-broadening-feature"></a><code>widen-broadening</code> Feature<a class="hash-link" href="#widen-broadening-feature" title="Direct link to heading">#</a></h4><p>The <code>widen-broadening</code> feature is added when number of tainted attributes of an
object reaches a certain threshold. For scalability reasons, Pysa cannot track
an infinite amount of attributes or indexes, and thus makes the approximation
that the whole object is tainted.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">d </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> condition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># c, d, e, etc.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">else</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># etc.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># too many indexes, the whole `d` variable becomes tainted.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="tito-broadening-feature"></a><code>tito-broadening</code> Feature<a class="hash-link" href="#tito-broadening-feature" title="Direct link to heading">#</a></h4><p>The <code>tito-broadening</code> feature is added when an object with tainted attributes is
propagated through a function to its return value. For correctness reasons, Pysa
makes the approximation that the whole returned object is tainted. This is
referred as &quot;Taint-In-Taint-Out collapsing&quot;.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">identity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> x</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># only `x[&quot;a&quot;]` is tainted.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> identity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># the whole `y` variable is tainted because of tito collapsing.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;b&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># since `y` is tainted, any access to `y` is also tainted.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="issue-broadening-feature"></a><code>issue-broadening</code> Feature<a class="hash-link" href="#issue-broadening-feature" title="Direct link to heading">#</a></h4><p>The <code>issue-broadening</code> feature is added when an object with a tainted attribute
reaches a taint sink. Pysa will consider the flow as valid even if the whole
object is not tainted.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">d </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># `d` itself is not tainted, but `d[&quot;a&quot;]` is, thus we emit an issue.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div></div><br><div class="row"><div class="col"><a href="https://github.com/facebook/pyre-check/tree/main/documentation/website/docs/pysa_features.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/pysa-basics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/pysa-advanced"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Advanced Topics »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#manually-added-features" class="table-of-contents__link">Manually Added Features</a><ul><li><a href="#via-feature-using-via" class="table-of-contents__link"><code>via</code> Feature Using <code>Via[]</code></a></li><li><a href="#via-value-feature-using-viavalueof" class="table-of-contents__link"><code>via-value</code> Feature Using <code>ViaValueOf[]</code></a></li><li><a href="#via-type-feature-using-viatypeof" class="table-of-contents__link"><code>via-type</code> Feature Using <code>ViaTypeOf[]</code></a></li><li><a href="#supporting-features-dynamically-using-viadynamicfeature" class="table-of-contents__link">Supporting Features Dynamically Using <code>ViaDynamicFeature[]</code></a></li></ul></li><li><a href="#automatic-features" class="table-of-contents__link">Automatic Features</a><ul><li><a href="#via-feature" class="table-of-contents__link"><code>via</code> Feature</a></li><li><a href="#type-feature" class="table-of-contents__link"><code>type</code> Feature</a></li><li><a href="#first-field-feature" class="table-of-contents__link"><code>first-field</code> Feature</a></li><li><a href="#first-index-feature" class="table-of-contents__link"><code>first-index</code> Feature</a></li><li><a href="#has-feature" class="table-of-contents__link"><code>has</code> Feature</a></li><li><a href="#always--modifier-on-features" class="table-of-contents__link"><code>always-</code> Modifier on Features</a></li><li><a href="#broadening-feature" class="table-of-contents__link"><code>broadening</code> Feature</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="https://docusaurus.io/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="https://docusaurus.io/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.be292107.js"></script>
<script src="/assets/js/main.2a1c4995.js"></script>
</body>
</html>