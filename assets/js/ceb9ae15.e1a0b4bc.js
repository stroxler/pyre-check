(self.webpackChunk=self.webpackChunk||[]).push([[559],{33605:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var r=n(67294),a=n(10308),o=n(94184),i=n.n(o),s=(n(36742),n(10412)),l=n(29656),u=n(99578);s.default.canUseDOM&&n(5321);function c(e){return r.createElement("div",{className:u.Z.card},r.createElement("h4",null,"Code"),r.createElement(f,{check:e.check,busy:e.busy}),r.createElement(l.fk,{value:e.code,options:{mode:"text/x-python",lineNumbers:!0,readOnly:!!e.busy&&"nocursor"},onBeforeChange:function(t,n,r){e.setCode(r)}}))}function d(e,t){var n=null;return"undefined"!=typeof window&&(n=localStorage.getItem(e)),n||t}function f(e){var t=e.busy?{color:"lightgrey",cursor:"default"}:null;return r.createElement("div",{style:{textAlign:"right"}},r.createElement("div",{className:i()("button button--outline button--secondary",u.Z.getStarted,u.Z.runPysa),style:t,onClick:e.check},e.busy?r.createElement("div",{className:u.Z.spinner}):null,"Run Pysa"))}function m(e){var t=e.results,n=t;return t&&(n=void 0!==t.errors?t.errors.join("\n"):t.data.errors.map((function(e){return e.line+":"+e.column+": "+e.description})).join("\n")||"No issues were detected by Pysa."),r.createElement("div",{className:i()(u.Z.card,u.Z.resultsCard)},r.createElement("h4",null,"Results"),r.createElement("div",{style:{fontFamily:"monospace"}},n||"Run Pysa to get results"))}function p(e){return r.createElement("div",{className:u.Z.card},r.createElement("h4",null,"Models"),r.createElement(l.fk,{value:e.model,options:{mode:"text/x-python",lineNumbers:!0,theme:"default height100"},onBeforeChange:function(t,n,r){e.setModel(r)}}),r.createElement("input",{type:"checkbox",defaultChecked:e.useOSModels,onChange:e.setUseOSModels}),r.createElement("label",null,"Use open source models"))}const h=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],o=(0,r.useState)(d("code",'import subprocess\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route("/rce/<string:payload>")\ndef definite_rce(payload: str) -> None:\n    subprocess.run(payload, shell=True)')),i=o[0],s=o[1],l=(0,r.useState)(!1),f=l[0],h=l[1],y=(0,r.useState)(d("model","#Define your custom models here")),b=y[0],g=y[1],k=(0,r.useState)(!0),v=k[0],_=k[1];return(0,r.useEffect)((function(){"undefined"!=typeof window&&(localStorage.setItem("code",i),localStorage.setItem("model",b))})),r.createElement(a.Z,{title:"Pysa Playground"},r.createElement("main",{className:u.Z.playgroundMain},r.createElement(p,{model:b,setModel:g,useOSModels:v,setUseOSModels:_}),r.createElement(m,{results:t}),r.createElement(c,{code:i,setCode:s,busy:f,check:function(){h(!0),setTimeout((function(){null===t&&(h(!1),n({errors:["Cannot reach server - request timed out"]}))}),2e3),fetch("http://localhost:5000/analyze",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:i,model:b,use_builtin_pysa_models:v})}).then((function(e){return e.json()})).then((function(e){n(e),h(!1)})).catch((function(e){return console.error(e)}))}})))}},5321:(e,t,n)=>{!function(e){"use strict";function t(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var n=t(["and","or","not","is"]),r=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],a=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"];function o(e){return e.scopes[e.scopes.length-1]}e.registerHelper("hintWords","python",r.concat(a)),e.defineMode("python",(function(i,s){for(var l="error",u=s.delimiters||s.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.\\]/,c=[s.singleOperators,s.doubleOperators,s.doubleDelimiters,s.tripleDelimiters,s.operators||/^([-+*/%\/&|^]=?|[<>=]+|\/\/=?|\*\*=?|!=|[~!@]|\.\.\.)/],d=0;d<c.length;d++)c[d]||c.splice(d--,1);var f=s.hangingIndent||i.indentUnit,m=r,p=a;null!=s.extra_keywords&&(m=m.concat(s.extra_keywords)),null!=s.extra_builtins&&(p=p.concat(s.extra_builtins));var h=!(s.version&&Number(s.version)<3);if(h){var y=s.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;m=m.concat(["nonlocal","False","True","None","async","await"]),p=p.concat(["ascii","bytes","exec","print"]);var b=new RegExp("^(([rbuf]|(br)|(fr))?('{3}|\"{3}|['\"]))","i")}else y=s.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/,m=m.concat(["exec","print"]),p=p.concat(["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"]),b=new RegExp("^(([rubf]|(ur)|(br))?('{3}|\"{3}|['\"]))","i");var g=t(m),k=t(p);function v(e,t){var n=e.sol()&&"\\"!=t.lastToken;if(n&&(t.indent=e.indentation()),n&&"py"==o(t).type){var r=o(t).offset;if(e.eatSpace()){var a=e.indentation();return a>r?z(t):a<r&&w(e,t)&&"#"!=e.peek()&&(t.errorToken=!0),null}var i=_(e,t);return r>0&&w(e,t)&&(i+=" "+l),i}return _(e,t)}function _(e,t,r){if(e.eatSpace())return null;if(!r&&e.match(/^#.*/))return"comment";if(e.match(/^[0-9\.]/,!1)){var a=!1;if(e.match(/^[\d_]*\.\d+(e[\+\-]?\d+)?/i)&&(a=!0),e.match(/^[\d_]+\.\d*/)&&(a=!0),e.match(/^\.\d+/)&&(a=!0),a)return e.eat(/J/i),"number";var o=!1;if(e.match(/^0x[0-9a-f_]+/i)&&(o=!0),e.match(/^0b[01_]+/i)&&(o=!0),e.match(/^0o[0-7_]+/i)&&(o=!0),e.match(/^[1-9][\d_]*(e[\+\-]?[\d_]+)?/)&&(e.eat(/J/i),o=!0),e.match(/^0(?![\dx])/i)&&(o=!0),o)return e.eat(/L/i),"number"}if(e.match(b))return-1!==e.current().toLowerCase().indexOf("f")?(t.tokenize=x(e.current(),t.tokenize),t.tokenize(e,t)):(t.tokenize=E(e.current(),t.tokenize),t.tokenize(e,t));for(var i=0;i<c.length;i++)if(e.match(c[i]))return"operator";return e.match(u)?"punctuation":"."==t.lastToken&&e.match(y)?"property":e.match(g)||e.match(n)?"keyword":e.match(k)?"builtin":e.match(/^(self|cls)\b/)?"variable-2":e.match(y)?"def"==t.lastToken||"class"==t.lastToken?"def":"variable":(e.next(),r?null:l)}function x(e,t){for(;"rubf".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var n=1==e.length,r="string";function a(e){return function(t,n){var r=_(t,n,!0);return"punctuation"==r&&("{"==t.current()?n.tokenize=a(e+1):"}"==t.current()&&(n.tokenize=e>1?a(e-1):o)),r}}function o(o,i){for(;!o.eol();)if(o.eatWhile(/[^'"\{\}\\]/),o.eat("\\")){if(o.next(),n&&o.eol())return r}else{if(o.match(e))return i.tokenize=t,r;if(o.match("{{"))return r;if(o.match("{",!1))return i.tokenize=a(0),o.current()?r:i.tokenize(o,i);if(o.match("}}"))return r;if(o.match("}"))return l;o.eat(/['"]/)}if(n){if(s.singleLineStringErrors)return l;i.tokenize=t}return r}return o.isString=!0,o}function E(e,t){for(;"rubf".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var n=1==e.length,r="string";function a(a,o){for(;!a.eol();)if(a.eatWhile(/[^'"\\]/),a.eat("\\")){if(a.next(),n&&a.eol())return r}else{if(a.match(e))return o.tokenize=t,r;a.eat(/['"]/)}if(n){if(s.singleLineStringErrors)return l;o.tokenize=t}return r}return a.isString=!0,a}function z(e){for(;"py"!=o(e).type;)e.scopes.pop();e.scopes.push({offset:o(e).offset+i.indentUnit,type:"py",align:null})}function S(e,t,n){var r=e.match(/^[\s\[\{\(]*(?:#|$)/,!1)?null:e.column()+1;t.scopes.push({offset:t.indent+f,type:n,align:r})}function w(e,t){for(var n=e.indentation();t.scopes.length>1&&o(t).offset>n;){if("py"!=o(t).type)return!0;t.scopes.pop()}return o(t).offset!=n}function C(e,t){e.sol()&&(t.beginningOfLine=!0);var n=t.tokenize(e,t),r=e.current();if(t.beginningOfLine&&"@"==r)return e.match(y,!1)?"meta":h?"operator":l;if(/\S/.test(r)&&(t.beginningOfLine=!1),"variable"!=n&&"builtin"!=n||"meta"!=t.lastToken||(n="meta"),"pass"!=r&&"return"!=r||(t.dedent+=1),"lambda"==r&&(t.lambda=!0),":"==r&&!t.lambda&&"py"==o(t).type&&e.match(/^\s*(?:#|$)/,!1)&&z(t),1==r.length&&!/string|comment/.test(n)){var a="[({".indexOf(r);if(-1!=a&&S(e,t,"])}".slice(a,a+1)),-1!=(a="])}".indexOf(r))){if(o(t).type!=r)return l;t.indent=t.scopes.pop().offset-f}}return t.dedent>0&&e.eol()&&"py"==o(t).type&&(t.scopes.length>1&&t.scopes.pop(),t.dedent-=1),n}return{startState:function(e){return{tokenize:v,scopes:[{offset:e||0,type:"py",align:null}],indent:e||0,lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var n=t.errorToken;n&&(t.errorToken=!1);var r=C(e,t);return r&&"comment"!=r&&(t.lastToken="keyword"==r||"punctuation"==r?e.current():r),"punctuation"==r&&(r=null),e.eol()&&t.lambda&&(t.lambda=!1),n?r+" "+l:r},indent:function(t,n){if(t.tokenize!=v)return t.tokenize.isString?e.Pass:0;var r=o(t),a=r.type==n.charAt(0);return null!=r.align?r.align-(a?1:0):r.offset-(a?f:0)},electricInput:/^\s*[\}\]\)]$/,closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"}})),e.defineMIME("text/x-python","python");var i=function(e){return e.split(" ")};e.defineMIME("text/x-cython",{name:"python",extra_keywords:i("by cdef cimport cpdef ctypedef enum except extern gil include nogil property public readonly struct union DEF IF ELIF ELSE")})}(n(4631))},99578:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={heroBanner:"heroBanner_3P7f",buttons:"buttons_1r9m",features:"features_3azU",media:"media_2ENC",featureImage:"featureImage_ZtzX",main:"main_17dy",playgroundMain:"playgroundMain_304S",heading:"heading_3aD-",spinner:"spinner_2dr8",spin:"spin_262F",card:"card_2AFH",runPysa:"runPysa_2s5o",resultsCard:"resultsCard_2mne"}}}]);