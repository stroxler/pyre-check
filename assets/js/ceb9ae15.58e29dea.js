"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[559],{33605:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=n(67294),a=n(10308),s=n(94184),o=n.n(s),l=(n(36742),n(10412)),u=n(29656),c=n(99578),d=function(){};l.default.canUseDOM&&(n(5321),d=n(57046));function i(e){return r.createElement("div",{className:c.Z.card},r.createElement("h4",null,"Code"),r.createElement(f,{check:e.check,busy:e.busy}),r.createElement(u.fk,{value:e.code,options:{mode:"text/x-python",lineNumbers:!0,readOnly:!!e.busy&&"nocursor"},onBeforeChange:function(t,n,r){e.setCode(r)}}))}function m(e,t){var n=null;return"undefined"!=typeof window&&(n=localStorage.getItem(e)),n||t}function f(e){var t=e.busy?{color:"lightgrey",cursor:"default"}:null;return r.createElement("div",{style:{textAlign:"right"}},r.createElement("div",{className:o()("button button--outline button--secondary",c.Z.getStarted,c.Z.runPysa),style:t,onClick:e.check},e.busy?r.createElement("div",{className:c.Z.spinner}):null,"Run Pysa"))}function p(e){var t=e.results,n=t;return t&&(n=void 0!==t.errors?t.errors.join("\n"):t.data.join("\n")),r.createElement("div",{className:o()(c.Z.card,c.Z.resultsCard)},r.createElement("h4",null,"Results"),r.createElement("div",{style:{fontFamily:"monospace"}},n||"Run Pysa to get results"))}function y(e){return r.createElement("div",{className:c.Z.card},r.createElement("h4",null,"Models"),r.createElement(u.fk,{value:e.model,options:{mode:"text/x-python",lineNumbers:!0,theme:"default height100"},onBeforeChange:function(t,n,r){e.setModel(r)}}),r.createElement("input",{type:"checkbox",defaultChecked:e.useOSModels,onChange:e.setUseOSModels}),r.createElement("label",null,"Use open source models"))}const h=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],s=(0,r.useState)(m("code",'import subprocess\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route("/rce/<string:payload>")\ndef definite_rce(payload: str) -> None:\n    subprocess.run(payload, shell=True)')),o=s[0],l=s[1],u=(0,r.useState)(!1),f=u[0],h=u[1],g=(0,r.useState)(m("model","#Define your custom models here")),v=g[0],_=g[1],E=(0,r.useState)(!0),b=E[0],k=E[1],C=d("ws://127.0.0.1:5000/analyze"),S=[];return(0,r.useEffect)((function(){"undefined"!=typeof window&&(localStorage.setItem("code",o),localStorage.setItem("model",v)),C.on("pysa_results_channel",(function(e){void 0===e.type?(n({errors:["Invalid data received from the server."]}),h(!1)):"finished"===e.type?h(!1):"output"===e.type&&(void 0===e.line?(n({errors:["Invalid data received from the server."]}),h(!1)):S.push(e.line),n({data:S}))})),C.on("connect_error",(function(){h(!1),n({errors:["Error establishing a connection to the server."]})}))}),[t]),r.createElement(a.Z,{title:"Pysa Playground"},r.createElement("main",{className:c.Z.playgroundMain},r.createElement(y,{model:v,setModel:_,useOSModels:b,setUseOSModels:k}),r.createElement(p,{results:t}),r.createElement(i,{code:o,setCode:l,busy:f,check:function(){h(!0),S=[],C.emit("analyze",{input:o,model:v,use_builtin_pysa_models:b})}})))}},99578:(e,t,n)=>{n.d(t,{Z:()=>r});const r={heroBanner:"heroBanner_3P7f",buttons:"buttons_1r9m",features:"features_3azU",media:"media_2ENC",featureImage:"featureImage_ZtzX",main:"main_17dy",playgroundMain:"playgroundMain_304S",heading:"heading_3aD-",spinner:"spinner_2dr8",spin:"spin_262F",card:"card_2AFH",runPysa:"runPysa_2s5o",resultsCard:"resultsCard_2mne"}}}]);